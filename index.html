<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bandit — Simple Price Calculator</title>
  <style>
    :root{--bg:#0f172a;--panel:#121826;--border:#223042;--text:#e5e7eb;--muted:#9ca3af;--accent:#22c55e;--danger:#ef4444}
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b1220,#0f172a);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
    header{padding:20px 12px;text-align:center;border-bottom:1px solid var(--border)}
    header .brand{display:flex;gap:12px;align-items:center;justify-content:center}
    header img{width:56px;height:56px;border-radius:12px;object-fit:cover;border:1px solid var(--border)}
    header .tag{color:var(--muted);font-size:12px;margin-top:4px}
    .wrap{max-width:820px;margin:0 auto;padding:20px}
    .card{background:rgba(18,24,38,.9);border:1px solid var(--border);border-radius:16px;padding:16px}
    .row{display:grid;grid-template-columns:1fr;gap:12px}
    @media(min-width:720px){.row-2{grid-template-columns:repeat(2,1fr)}.row-3{grid-template-columns:repeat(3,1fr)}}
    label{font-size:13px;color:#cbd5e1}
    input,select{width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;background:#0b1220;color:var(--text)}
    .muted{color:var(--muted);font-size:12px}
    .btn{appearance:none;border:none;background:var(--accent);color:#052412;font-weight:800;padding:12px 14px;border-radius:12px;cursor:pointer;width:100%}
    .btn.ghost{background:transparent;border:1px solid var(--border);color:var(--text)}
    .grid-actions{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
    .priceBox{margin-top:14px;text-align:center}
    .price{font-size:44px;font-weight:900;margin:2px 0}
    .pill{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#0b1220;color:#cbd5e1;font-size:12px}
    details{margin-top:12px}
    summary{cursor:pointer;color:#cbd5e1}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>
<body>
  <header>
    <div class="brand">
      <img id="logo" src="logo.png" alt="Bandit Logo" />
      <div>
        <h1 style="margin:0;font-size:22px">Bandit Property Cleanout — Quick Quote</h1>
        <div class="tag">Phone: <strong>601-647-4019</strong> • Hinds & Rankin County</div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <div class="card">
      <div class="row row-2">
        <div>
          <label for="jobType">Job type</label>
          <select id="jobType">
            <option value="haul_light">Light Haul (F150)</option>
            <option value="haul_heavy">Heavy Haul (F250)</option>
            <option value="lawn_mow">Lawn: Mow & Trim (F150)</option>
            <option value="hedge_trim">Lawn: Hedge Trim (F150)</option>
            <option value="limb_cut">Limb Cutting (F250)</option>
            <option value="combo">Combo: Haul + Lawn (F250)</option>
          </select>
          <div class="muted">Vehicle auto-sets: F150 for light, F250 for heavy.</div>
        </div>
        <div>
          <label for="equipment">Equipment</label>
          <select id="equipment"></select>
          <div class="muted">Options change based on job type.</div>
        </div>
      </div>

      <div class="row row-3" style="margin-top:8px">
        <div>
          <label for="miles">Round-trip miles</label>
          <input id="miles" type="number" placeholder="e.g., 30" />
        </div>
        <div>
          <label for="dumpFee">Dump fee ($)</label>
          <input id="dumpFee" type="number" placeholder="Auto-set by job" />
        </div>
        <div>
          <label for="addOn">Surcharge ($)</label>
          <input id="addOn" type="number" placeholder="hazard/perishables, tires, etc." />
        </div>
      </div>

      <div class="grid-actions">
        <button class="btn" id="calc">Calculate Price</button>
        <button class="btn ghost" id="pdf">PDF Invoice</button>
      </div>

      <div class="priceBox">
        <div class="pill">Customer Price</div>
        <div class="price" id="price">$0</div>
        <div class="muted" id="note">Includes estimated costs (fuel, dump, labor, equipment) and margin.</div>
      </div>

      <details>
        <summary>Advanced (optional)</summary>
        <div class="row row-3" style="margin-top:8px">
          <div>
            <label for="profitPct">Target profit margin %</label>
            <input id="profitPct" type="number" value="25" />
          </div>
          <div>
            <label for="overheadPct">Overhead %</label>
            <input id="overheadPct" type="number" value="15" />
          </div>
          <div>
            <label for="fuelPrice">Fuel price $/gal</label>
            <input id="fuelPrice" type="number" step="0.01" value="3.05" />
          </div>
        </div>
        <div class="row row-3">
          <div>
            <label for="yourHours">Your hours</label>
            <input id="yourHours" type="number" step="0.1" />
          </div>
          <div>
            <label for="workerHours">Worker hours</label>
            <input id="workerHours" type="number" step="0.1" />
          </div>
          <div>
            <label for="ccFeePct">Card fee %</label>
            <input id="ccFeePct" type="number" step="0.1" value="0" />
          </div>
        </div>
      </details>
    </div>
  </div>

  <script>
    const $ = id => document.getElementById(id);

    // Config maps kept simple
    const VEHICLE = { F150:{mpg:13}, F250:{mpg:12} };
    const JOBS = {
      haul_light: { vehicle:'F150', dump:60, equip:[['none','No extra equipment',0], ['hand','Hand tools',5], ['chainsaw','Chainsaw',25]] , hours:[2,2] },
      haul_heavy: { vehicle:'F250', dump:100, equip:[['chainsaw','Chainsaw',25], ['appliance','Appliance dolly',8], ['none','No extra equipment',0]], hours:[3,3] },
      lawn_mow:   { vehicle:'F150', dump:40, equip:[['mowtrim','Mower + Trimmer',25], ['none','No extra equipment',0]], hours:[1.5,1.5] },
      hedge_trim: { vehicle:'F150', dump:40, equip:[['hedge','Hedge trimmer',15], ['mowtrim','Mower + Trimmer',25]], hours:[1,1] },
      limb_cut:   { vehicle:'F250', dump:80, equip:[['chainsaw','Chainsaw',25]], hours:[2,2] },
      combo:      { vehicle:'F250', dump:100, equip:[['combo','Haul + Mow/Trim',45]], hours:[3,3] }
    };
    const EQUIP_COST = { none:0, hand:5, chainsaw:25, appliance:8, mowtrim:25, hedge:15, combo:45 };

    function setJobDefaults(){
      const j = JOBS[$('jobType').value];
      // equipment dropdown
      const sel = $('equipment'); sel.innerHTML='';
      j.equip.forEach(([val,label])=>{ const o=document.createElement('option'); o.value=val; o.textContent=`${label} ($${EQUIP_COST[val]})`; sel.appendChild(o); });
      $('dumpFee').value = j.dump;
      $('miles').value = $('miles').value || 30;
      // set inferred hours in placeholders (can be overridden in Advanced)
      $('yourHours').placeholder = j.hours[0];
      $('workerHours').placeholder = j.hours[1];
    }

    function mpgForJob(){ return VEHICLE[JOBS[$('jobType').value].vehicle].mpg; }

    function hours(){
      const j = JOBS[$('jobType').value];
      const you = parseFloat($('yourHours').value||j.hours[0]);
      const worker = parseFloat($('workerHours').value||j.hours[1]);
      return {you, worker, total: you+worker};
    }

    function fuelCost(){
      const miles = parseFloat($('miles').value||0);
      const mpg = mpgForJob();
      const fuelPrice = parseFloat($('fuelPrice').value||3.05);
      if(!mpg) return 0;
      return (miles/mpg)*fuelPrice;
    }

    function equipmentCost(){ return EQUIP_COST[$('equipment').value]||0; }

    function calcCustomerPrice(){
      const dump = parseFloat($('dumpFee').value||0);
      const addOn = parseFloat($('addOn').value||0);
      const tools = equipmentCost();
      const fuel = fuelCost();
      const hrs = hours();
      // Simple labor rates baked in
      const yourRate = 20, workerRate = 15;
      const labor = hrs.you*yourRate + hrs.worker*workerRate;
      let base = dump + addOn + tools + fuel + labor;
      const overhead = base * (parseFloat($('overheadPct').value||15)/100);
      base += overhead;
      // margin on revenue
      const pm = parseFloat($('profitPct').value||25)/100;
      const card = (parseFloat($('ccFeePct').value||0)/100);
      let price = base / (1 - pm);
      price += price * card; // add card fee if any
      return { price, breakdown:{dump,addOn,tools,fuel,labor,overhead,profit: price - (base + price*card)} };
    }

    function render(){
      const r = calcCustomerPrice();
      $('price').textContent = `$${Math.round(r.price)}`;
    }

    $('jobType').addEventListener('change', ()=>{ setJobDefaults(); render(); });
    $('equipment').addEventListener('change', render);
    ['miles','dumpFee','addOn','profitPct','overheadPct','fuelPrice','yourHours','workerHours','ccFeePct'].forEach(id=>{
      $(id).addEventListener('input', render);
    });

    // PDF (minimal invoice)
    async function genPDF(){
      const { jsPDF } = window.jspdf; const doc = new jsPDF();
      const priceText = document.getElementById('price').textContent;
      doc.setFontSize(16); doc.text('Bandit Property Cleanout', 14, 18);
      doc.setFontSize(10); doc.text('Phone: 601-647-4019', 14, 24);
      doc.setFontSize(12); doc.text('Quick Quote', 14, 34);
      doc.text(`Job: ${$('#jobType').selectedOptions[0].text}`, 14, 42);
      doc.text(`Equipment: ${$('#equipment').selectedOptions[0].text}`, 14, 49);
      doc.text(`Miles (RT): ${$('#miles').value||0}`, 14, 56);
      doc.text(`Dump fee: $${$('#dumpFee').value||0}`, 14, 63);
      doc.setFontSize(18); doc.text(`Customer Price: ${priceText}`, 14, 78);
      doc.save('Bandit_Quote.pdf');
    }
    $('pdf').addEventListener('click', genPDF);

    // init
    setJobDefaults();
    render();
  </script>
</body>
</html>
